2024-04-28 00:01:06,407 INFO    MainThread:125255 [wandb_setup.py:_flush():76] Current SDK version is 0.16.6
2024-04-28 00:01:06,407 INFO    MainThread:125255 [wandb_setup.py:_flush():76] Configure stats pid to 125255
2024-04-28 00:01:06,407 INFO    MainThread:125255 [wandb_setup.py:_flush():76] Loading settings from /root/.config/wandb/settings
2024-04-28 00:01:06,407 INFO    MainThread:125255 [wandb_setup.py:_flush():76] Loading settings from /workspace/nathan/RWKV-LM/RWKV-v5/wandb/settings
2024-04-28 00:01:06,407 INFO    MainThread:125255 [wandb_setup.py:_flush():76] Loading settings from environment variables: {}
2024-04-28 00:01:06,407 INFO    MainThread:125255 [wandb_setup.py:_flush():76] Applying setup settings: {'_disable_service': False}
2024-04-28 00:01:06,407 INFO    MainThread:125255 [wandb_setup.py:_flush():76] Inferring run settings from compute environment: {'program_relpath': 'train.py', 'program_abspath': '/workspace/nathan/RWKV-LM/RWKV-v5/train.py', 'program': '/workspace/nathan/RWKV-LM/RWKV-v5/train.py'}
2024-04-28 00:01:06,407 INFO    MainThread:125255 [wandb_setup.py:_flush():76] Applying login settings: {}
2024-04-28 00:01:06,407 INFO    MainThread:125255 [wandb_init.py:_log_setup():521] Logging user logs to /workspace/nathan/RWKV-LM/RWKV-v5/wandb/run-20240428_000106-j3q31tiw/logs/debug.log
2024-04-28 00:01:06,407 INFO    MainThread:125255 [wandb_init.py:_log_setup():522] Logging internal logs to /workspace/nathan/RWKV-LM/RWKV-v5/wandb/run-20240428_000106-j3q31tiw/logs/debug-internal.log
2024-04-28 00:01:06,407 INFO    MainThread:125255 [wandb_init.py:init():561] calling init triggers
2024-04-28 00:01:06,408 INFO    MainThread:125255 [wandb_init.py:init():568] wandb.init called with sweep_config: {}
config: {'load_model': '/checkpoint/testload/L32-D4096-x060/rwkv-init.pth', 'wandb': '70B-RUN', 'proj_dir': '/checkpoint/testload/L32-D4096-x060', 'random_seed': -1, 'train_type': '', 'data_file': '/checkpoint/moe-dataset/1.5a/dataset_chunk_0_text_document', 'data_type': 'binidx', 'vocab_size': 65536, 'ctx_len': 512, 'epoch_steps': 1260, 'epoch_count': 6429, 'epoch_begin': 0, 'epoch_save': 1, 'micro_bsz': 4, 'n_layer': 32, 'n_embd': 4096, 'dim_att': 4096, 'dim_ffn': 14336, 'pre_ffn': 0, 'head_qk': 0, 'tiny_att_dim': 0, 'tiny_att_layer': -999, 'lr_init': 0.0001, 'lr_final': 1e-05, 'warmup_steps': 0, 'beta1': 0.9, 'beta2': 0.99, 'adam_eps': 1e-08, 'grad_cp': 1, 'dropout': 0, 'weight_decay': 0.0001, 'weight_decay_final': -1, 'my_pile_version': 1, 'my_pile_stage': 3, 'my_pile_shift': 0, 'my_pile_edecay': 0, 'layerwise_lr': 1, 'ds_bucket_mb': 200, 'my_sample_len': 0, 'my_ffn_shift': 1, 'my_att_shift': 1, 'head_size_a': 64, 'head_size_divisor': 8, 'my_pos_emb': 0, 'load_partial': 0, 'magic_prime': 259241513, 'my_qa_mask': 0, 'my_random_steps': 0, 'my_testing': 'x060', 'my_exit': 99999999, 'my_exit_tokens': 132731667543, 'accelerator': 'gpu', 'strategy': 'deepspeed_stage_3', 'devices': 8, 'num_nodes': 1, 'precision': 'bf16-mixed', 'accumulate_grad_batches': 1, 'my_timestamp': '2024-04-28-00-00-25', 'enable_checkpointing': False, 'replace_sampler_ddp': False, 'logger': False, 'gradient_clip_val': 1.0, 'num_sanity_val_steps': 0, 'check_val_every_n_epoch': 100000000000000000000, 'log_every_n_steps': 100000000000000000000, 'max_epochs': -1, 'betas': (0.9, 0.99), 'real_bsz': 32, 'run_name': '65536 ctx512 L32 D4096', 'trainer': <pytorch_lightning.trainer.trainer.Trainer object at 0x7fd149c5cf40>, 'actual_model_path': '/checkpoint/testload/L32-D4096-x060/rwkv-init.pth'}
2024-04-28 00:01:06,408 INFO    MainThread:125255 [wandb_init.py:init():611] starting backend
2024-04-28 00:01:06,408 INFO    MainThread:125255 [wandb_init.py:init():615] setting up manager
2024-04-28 00:01:06,408 INFO    MainThread:125255 [backend.py:_multiprocessing_setup():105] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2024-04-28 00:01:06,409 INFO    MainThread:125255 [wandb_init.py:init():623] backend started and connected
2024-04-28 00:01:06,411 INFO    MainThread:125255 [wandb_init.py:init():715] updated telemetry
2024-04-28 00:01:06,417 INFO    MainThread:125255 [wandb_init.py:init():748] communicating run to backend with 90.0 second timeout
2024-04-28 00:01:06,829 INFO    MainThread:125255 [wandb_run.py:_on_init():2357] communicating current version
2024-04-28 00:01:06,929 INFO    MainThread:125255 [wandb_run.py:_on_init():2366] got version response 
2024-04-28 00:01:06,930 INFO    MainThread:125255 [wandb_init.py:init():799] starting run threads in backend
2024-04-28 00:01:07,031 WARNING MainThread:125255 [wandb_init.py:init():1203] interrupted
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/wandb/sdk/wandb_init.py", line 1181, in init
    run = wi.init()
  File "/usr/local/lib/python3.10/dist-packages/wandb/sdk/wandb_init.py", line 812, in init
    run_start_result = run_start_handle.wait(timeout=30)
  File "/usr/local/lib/python3.10/dist-packages/wandb/sdk/lib/mailbox.py", line 283, in wait
    found, abandoned = self._slot._get_and_clear(timeout=wait_timeout)
  File "/usr/local/lib/python3.10/dist-packages/wandb/sdk/lib/mailbox.py", line 130, in _get_and_clear
    if self._wait(timeout=timeout):
  File "/usr/local/lib/python3.10/dist-packages/wandb/sdk/lib/mailbox.py", line 126, in _wait
    return self._event.wait(timeout=timeout)
  File "/usr/lib/python3.10/threading.py", line 607, in wait
    signaled = self._cond.wait(timeout)
  File "/usr/lib/python3.10/threading.py", line 324, in wait
    gotit = waiter.acquire(True, timeout)
KeyboardInterrupt
